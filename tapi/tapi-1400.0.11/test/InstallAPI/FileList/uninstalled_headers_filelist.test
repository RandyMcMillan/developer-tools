; RUN: rm -rf %t && mkdir -p %t
; RUN: sed -e "s:INPUT_DIR:%S/Inputs:g" %S/Inputs/uninstalled_headers.json > %t/uninstalled_headers.json
; RUN: %tapi installapi --filetype=tbd-v4 --filelist=%t/uninstalled_headers.json -target x86_64-apple-macosx.10.15 -install_name /System/Library/Frameworks/Foo.framework/Foo -isysroot %sysroot -o %t/Foo1.tbd 2>&1 | FileCheck %s --allow-empty
; CHECK-NOT: error: 
; CHECK-NOT: warning:

; RUN: cat %t/Foo1.tbd | FileCheck %s --check-prefix=OUTPUT

; OUTPUT: --- !tapi-tbd
; OUTPUT-NEXT: tbd-version:     4
; OUTPUT-NEXT: targets:         [ x86_64-macos ]
; OUTPUT-NEXT: flags:           [ not_app_extension_safe, installapi ]
; OUTPUT-NEXT: install-name:    '/System/Library/Frameworks/Foo.framework/Foo'
; OUTPUT-NEXT: current-version: 0
; OUTPUT-NEXT: compatibility-version: 0
; OUTPUT-NEXT: exports:
; OUTPUT-NEXT:   - targets:         [ x86_64-macos ]
; OUTPUT-NEXT:     symbols:         [ _bar_internal, _secret_api ]
; OUTPUT-NEXT: ...

